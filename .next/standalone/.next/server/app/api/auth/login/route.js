(()=>{var e={};e.id=758,e.ids=[758],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7462:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,z:()=>s});var r=a(96330);let s=globalThis.prisma??new r.PrismaClient({log:["error"]});process.on("beforeExit",async()=>{await s.$disconnect()});let i=s},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14985:e=>{"use strict";e.exports=require("dns")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36781:(e,t,a)=>{"use strict";a.d(t,{PP:()=>l,xC:()=>u});var r=a(70300),s=a.n(r);let i={host:process.env.REDIS_HOST||"localhost",port:parseInt(process.env.REDIS_PORT||"6379"),password:process.env.REDIS_PASSWORD,maxRetriesPerRequest:3,retryDelayOnFailover:100,enableReadyCheck:!0,lazyConnect:!0};class n{static{this.instance=null}static{this.isConnected=!1}static getInstance(){return this.instance||(this.instance=new(s())(i),this.instance.on("connect",()=>{this.isConnected=!0}),this.instance.on("error",e=>{console.error("âŒ Redis error:",e.message),this.isConnected=!1}),this.instance.on("close",()=>{this.isConnected=!1})),this.instance}static async connect(){try{let e=this.getInstance();return await e.connect(),!0}catch{return console.warn("Redis connection failed, using fallback cache"),!1}}static getConnectionStatus(){return this.isConnected}}let o=n.getInstance(),l={async get(e){try{let t=await o.get(e);return t?JSON.parse(t):null}catch{return null}},async set(e,t,a=3600){try{return await o.setex(e,a,JSON.stringify(t)),!0}catch{return!1}},async del(e){try{return await o.del(e),!0}catch{return!1}},async invalidatePattern(e){try{let t=await o.keys(e);t.length>0&&await o.del(...t)}catch{console.error("Failed to invalidate cache pattern:",e)}},async getOrSet(e,t,a=3600){let r=await this.get(e);if(null!==r)return r;let s=await t();return await this.set(e,s,a),s}},u={async checkLimit(e,t,a){let r=Date.now(),s=`ratelimit:${e}:${Math.floor(r/(1e3*a))}`;try{let e=await o.incr(s);1===e&&await o.expire(s,a);let i=Math.max(0,t-e),n=Math.ceil(r/(1e3*a))*a*1e3;return{allowed:e<=t,remaining:i,resetAt:n}}catch{return{allowed:!0,remaining:t,resetAt:r+1e3*a}}}}},41204:e=>{"use strict";e.exports=require("string_decoder")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45740:(e,t,a)=>{"use strict";a.d(t,{Ng:()=>p,nM:()=>m,vF:()=>d});var r=a(91728),s=a.n(r);let{combine:i,timestamp:n,printf:o,colorize:l,errors:u}=s().format,c=o(({level:e,message:t,timestamp:a,stack:r,...s})=>{let i=`${a} [${e}]: ${t}`;return Object.keys(s).length>0&&(i+=` ${JSON.stringify(s)}`),r&&(i+=`
${r}`),i}),d=s().createLogger({level:process.env.LOG_LEVEL||"info",format:i(u({stack:!0}),n({format:"YYYY-MM-DD HH:mm:ss"}),c),defaultMeta:{service:"studystreak"},transports:[new(s()).transports.Console({format:i(l({all:!0}),c)})]});d.add(new(s()).transports.File({filename:"logs/error.log",level:"error",maxsize:5242880,maxFiles:5})),d.add(new(s()).transports.File({filename:"logs/combined.log",maxsize:5242880,maxFiles:5}));let m=(e,t,a,r)=>{d.info("AI Request",{action:e,model:t,tokens:a,duration:r?`${r}ms`:void 0})},p=(e,t,a)=>{d[t>1e3?"warn":"info"]("Performance",{operation:e,duration:`${t}ms`,slow:t>1e3,...a})}},49120:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>w,routeModule:()=>x,serverHooks:()=>f,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>g});var r={};a.r(r),a.d(r,{POST:()=>p});var s=a(96559),i=a(48088),n=a(37719),o=a(32190),l=a(7462),u=a(81310),c=a(61774),d=a(45740),m=a(44999);async function p(e){try{let t=await e.json(),a=c.X5.safeParse(t);if(!a.success)return o.NextResponse.json({error:"Invalid email or password"},{status:400});let{email:r,password:s}=a.data,i=await l.z.user.findUnique({where:{email:r.toLowerCase()},select:{id:!0,email:!0,name:!0,password:!0,role:!0,avatar:!0,currentStreak:!0,longestStreak:!0,totalFocusTime:!0,level:!0,experience:!0}});if(!i)return o.NextResponse.json({error:"Invalid email or password"},{status:401});if(!await (0,u.BE)(s,i.password))return d.vF.warn("Failed login attempt",{email:r.toLowerCase()}),o.NextResponse.json({error:"Invalid email or password"},{status:401});let n=await (0,u.HU)({userId:i.id,email:i.email,role:i.role});return(await (0,m.UL)()).set("auth-token",n,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800,path:"/"}),await l.z.user.update({where:{id:i.id},data:{lastLoginAt:new Date}}),d.vF.info("User logged in successfully",{userId:i.id}),o.NextResponse.json({message:"Login successful",user:{id:i.id,email:i.email,name:i.name,avatar:i.avatar,currentStreak:i.currentStreak,longestStreak:i.longestStreak,totalFocusTime:i.totalFocusTime,level:i.level,experience:i.experience}})}catch(e){return d.vF.error("Login error",{error:e}),o.NextResponse.json({error:"An error occurred during login"},{status:500})}}let x=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/ronakkumar/Desktop/make-it/Make_it/app/api/auth/login/route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:h,workUnitAsyncStorage:g,serverHooks:f}=x;function w(){return(0,n.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:g})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57729:()=>{},61774:(e,t,a)=>{"use strict";a.d(t,{Vs:()=>o,X5:()=>s,cU:()=>n,zK:()=>i});var r=a(10209);let s=r.Ik({email:r.Yj().email("Invalid email address"),password:r.Yj().min(8,"Password must be at least 8 characters"),remember:r.zM().optional().default(!1)}),i=r.Ik({name:r.Yj().min(2,"Name must be at least 2 characters").max(50,"Name must be less than 50 characters").regex(/^[a-zA-Z\s]+$/,"Name can only contain letters and spaces"),email:r.Yj().email("Invalid email address"),password:r.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number").regex(/[^A-Za-z0-9]/,"Password must contain at least one special character"),confirmPassword:r.Yj(),acceptTerms:r.zM().refine(e=>!0===e,"You must accept the terms")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});r.Ik({title:r.Yj().min(1,"Title is required").max(200,"Title must be less than 200 characters"),description:r.Yj().max(2e3,"Description too long").optional(),priority:r.k5(["LOW","MEDIUM","HIGH","URGENT"]).default("MEDIUM"),dueDate:r.Yj().datetime().optional().nullable(),estimatedTime:r.ai().min(1).max(480).optional(),tags:r.YO(r.Yj().max(30)).max(10).optional()}).partial().extend({status:r.k5(["PENDING","IN_PROGRESS","COMPLETED","ARCHIVED"]).optional()}),r.Ik({type:r.k5(["POMODORO","DEEP_WORK","CUSTOM"]).default("POMODORO"),duration:r.ai().min(1).max(240),taskId:r.Yj().cuid().optional(),notes:r.Yj().max(1e3).optional()}),r.Ik({title:r.Yj().min(3,"Title must be at least 3 characters").max(100,"Title must be less than 100 characters"),description:r.Yj().max(500).optional(),type:r.k5(["STUDY_TIME","TASK_COMPLETION","STREAK","CUSTOM"]),goal:r.ai().min(1,"Goal must be at least 1"),unit:r.Yj().min(1).max(20),startDate:r.Yj().datetime(),endDate:r.Yj().datetime(),isPublic:r.zM().default(!0)}).refine(e=>new Date(e.endDate)>new Date(e.startDate),{message:"End date must be after start date",path:["endDate"]});let n=r.Ik({message:r.Yj().min(1,"Message is required").max(4e3,"Message too long"),conversationId:r.Yj().cuid().optional(),context:r.Ik({currentTask:r.Yj().optional(),studyGoal:r.Yj().optional(),timeAvailable:r.ai().optional()}).optional()});r.Ik({theme:r.k5(["light","dark","system"]).default("system"),focusDuration:r.ai().min(5).max(120).default(25),shortBreakDuration:r.ai().min(1).max(30).default(5),longBreakDuration:r.ai().min(5).max(60).default(15),dailyGoal:r.ai().min(15).max(720).default(120),notificationsEnabled:r.zM().default(!0),soundEnabled:r.zM().default(!0),reducedMotion:r.zM().default(!1),aiPersonalization:r.zM().default(!0)});let o=r.Ik({page:r.au.number().min(1).default(1),limit:r.au.number().min(1).max(100).default(20),sortBy:r.Yj().optional(),sortOrder:r.k5(["asc","desc"]).default("desc")}).extend({status:r.k5(["PENDING","IN_PROGRESS","COMPLETED","ARCHIVED"]).optional(),priority:r.k5(["LOW","MEDIUM","HIGH","URGENT"]).optional(),search:r.Yj().max(100).optional(),tags:r.Yj().optional()})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81310:(e,t,a)=>{"use strict";a.d(t,{BE:()=>c,Er:()=>u,HU:()=>d,Ht:()=>p,nr:()=>m});var r=a(85663),s=a(43205),i=a.n(s),n=a(44999),o=a(36781);let l=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production";async function u(e){return r.Ay.hash(e,12)}async function c(e,t){return r.Ay.compare(e,t)}function d(e){return i().sign(e,l,{expiresIn:"7d"})}function m(e){try{return i().verify(e,l)}catch{return null}}async function p(){let e=await (0,n.UL)(),t=e.get("auth-token")?.value;return!t||await o.PP.get(`blacklist:${t}`)?null:m(t)}},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[447,475,999,315,300,209],()=>a(49120));module.exports=r})();