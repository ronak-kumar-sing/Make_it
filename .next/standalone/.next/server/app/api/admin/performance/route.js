(()=>{var e={};e.id=324,e.ids=[324],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7462:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,z:()=>n});var s=r(96330);let n=globalThis.prisma??new s.PrismaClient({log:["error"]});process.on("beforeExit",async()=>{await n.$disconnect()});let a=n},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14985:e=>{"use strict";e.exports=require("dns")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36781:(e,t,r)=>{"use strict";r.d(t,{PP:()=>c,xC:()=>u});var s=r(70300),n=r.n(s);let a={host:process.env.REDIS_HOST||"localhost",port:parseInt(process.env.REDIS_PORT||"6379"),password:process.env.REDIS_PASSWORD,maxRetriesPerRequest:3,retryDelayOnFailover:100,enableReadyCheck:!0,lazyConnect:!0};class i{static{this.instance=null}static{this.isConnected=!1}static getInstance(){return this.instance||(this.instance=new(n())(a),this.instance.on("connect",()=>{this.isConnected=!0}),this.instance.on("error",e=>{console.error("âŒ Redis error:",e.message),this.isConnected=!1}),this.instance.on("close",()=>{this.isConnected=!1})),this.instance}static async connect(){try{let e=this.getInstance();return await e.connect(),!0}catch{return console.warn("Redis connection failed, using fallback cache"),!1}}static getConnectionStatus(){return this.isConnected}}let o=i.getInstance(),c={async get(e){try{let t=await o.get(e);return t?JSON.parse(t):null}catch{return null}},async set(e,t,r=3600){try{return await o.setex(e,r,JSON.stringify(t)),!0}catch{return!1}},async del(e){try{return await o.del(e),!0}catch{return!1}},async invalidatePattern(e){try{let t=await o.keys(e);t.length>0&&await o.del(...t)}catch{console.error("Failed to invalidate cache pattern:",e)}},async getOrSet(e,t,r=3600){let s=await this.get(e);if(null!==s)return s;let n=await t();return await this.set(e,n,r),n}},u={async checkLimit(e,t,r){let s=Date.now(),n=`ratelimit:${e}:${Math.floor(s/(1e3*r))}`;try{let e=await o.incr(n);1===e&&await o.expire(n,r);let a=Math.max(0,t-e),i=Math.ceil(s/(1e3*r))*r*1e3;return{allowed:e<=t,remaining:a,resetAt:i}}catch{return{allowed:!0,remaining:t,resetAt:s+1e3*r}}}}},41204:e=>{"use strict";e.exports=require("string_decoder")},44342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>x,serverHooks:()=>g,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>m,runtime:()=>d});var n=r(96559),a=r(48088),i=r(37719),o=r(32190),c=r(81310),u=r(36781),l=r(7462),p=r(45740);let d="nodejs";async function m(e){let t=Date.now();try{let e=await (0,c.Ht)();if(!e||"ADMIN"!==e.role)return o.NextResponse.json({error:"Forbidden"},{status:403});let r={timestamp:new Date().toISOString(),system:{uptime:process.uptime(),memory:process.memoryUsage(),nodeVersion:process.version},database:await h(),cache:await y(),recommendations:[]};return r.system.memory.heapUsed>0x19000000&&r.recommendations.push("Memory usage is high. Consider optimizing memory-intensive operations."),(0,p.Ng)("admin-performance-check",Date.now()-t),o.NextResponse.json(r)}catch(e){return p.vF.error("Performance metrics fetch failed",{error:e}),o.NextResponse.json({error:"Failed to fetch metrics"},{status:500})}}async function h(){let e=Date.now();try{await l.A.$queryRaw`SELECT 1`;let t=Date.now()-e,[r,s,n]=await Promise.all([l.A.user.count(),l.A.task.count(),l.A.focusSession.count()]);return{status:"healthy",queryLatency:t,tables:{users:r,tasks:s,sessions:n}}}catch(e){return{status:"error",error:e instanceof Error?e.message:"Unknown error"}}}async function y(){try{let e=Date.now();await u.PP.set("health-check","ok",10),await u.PP.get("health-check");let t=Date.now()-e;return{status:"healthy",latency:t}}catch{return{status:"unavailable",latency:0}}}let x=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/admin/performance/route",pathname:"/api/admin/performance",filename:"route",bundlePath:"app/api/admin/performance/route"},resolvedPagePath:"/Users/ronakkumar/Desktop/make-it/Make_it/app/api/admin/performance/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:f,serverHooks:g}=x;function v(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:f})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45740:(e,t,r)=>{"use strict";r.d(t,{Ng:()=>m,nM:()=>d,vF:()=>p});var s=r(91728),n=r.n(s);let{combine:a,timestamp:i,printf:o,colorize:c,errors:u}=n().format,l=o(({level:e,message:t,timestamp:r,stack:s,...n})=>{let a=`${r} [${e}]: ${t}`;return Object.keys(n).length>0&&(a+=` ${JSON.stringify(n)}`),s&&(a+=`
${s}`),a}),p=n().createLogger({level:process.env.LOG_LEVEL||"info",format:a(u({stack:!0}),i({format:"YYYY-MM-DD HH:mm:ss"}),l),defaultMeta:{service:"studystreak"},transports:[new(n()).transports.Console({format:a(c({all:!0}),l)})]});p.add(new(n()).transports.File({filename:"logs/error.log",level:"error",maxsize:5242880,maxFiles:5})),p.add(new(n()).transports.File({filename:"logs/combined.log",maxsize:5242880,maxFiles:5}));let d=(e,t,r,s)=>{p.info("AI Request",{action:e,model:t,tokens:r,duration:s?`${s}ms`:void 0})},m=(e,t,r)=>{p[t>1e3?"warn":"info"]("Performance",{operation:e,duration:`${t}ms`,slow:t>1e3,...r})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57729:()=>{},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81310:(e,t,r)=>{"use strict";r.d(t,{BE:()=>l,Er:()=>u,HU:()=>p,Ht:()=>m,nr:()=>d});var s=r(85663),n=r(43205),a=r.n(n),i=r(44999),o=r(36781);let c=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production";async function u(e){return s.Ay.hash(e,12)}async function l(e,t){return s.Ay.compare(e,t)}function p(e){return a().sign(e,c,{expiresIn:"7d"})}function d(e){try{return a().verify(e,c)}catch{return null}}async function m(){let e=await (0,i.UL)(),t=e.get("auth-token")?.value;return!t||await o.PP.get(`blacklist:${t}`)?null:d(t)}},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,475,999,315,300],()=>r(44342));module.exports=s})();